<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Browse Restaurants</title>
</head>
<body>
  <h1>Browse Restaurants</h1>

  {% if restaurants %}
    <ul>
      {% for r in restaurants %}
        <li>
          <strong>{{ r.name }}</strong>
          {% if r.cuisine %} — {{ r.cuisine }}{% endif %}
          {% if r.city %} ({{ r.city }}){% endif %}
          <div>{{ r.description|default:"" }}</div>

          {# ✅ Booking CTA:
             - Guests → /login/?next=/reserve/<id>   (so after login they go straight to this restaurant's reserve page)
             - Authenticated → /reserve/<id>         (direct access)
          #}
          {% if not request.user.is_authenticated %}
            <a href="{% url 'login' %}?next={% url 'reserve' r.pk %}">Reserve now</a>
          {% else %}
            <a href="{% url 'reserve' r.pk %}">Reserve now</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No restaurants yet. Go to <a href="/admin/">Admin</a> to add some.</p>
  {% endif %}
</body>
</html>
